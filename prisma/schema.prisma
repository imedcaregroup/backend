// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}



model User {
  id      Int      @id @default(autoincrement())
  email   String?  @unique
  password    String?
  authProvider String
  googleId String?
  mobileNumber String?
  otp Int?
  name String? 
  surName String?
  pytroNym String?
  dob DateTime?
  gender String?
  country String?
  address String?
  lat Float?
  lng Float?
  notificationEnabled Boolean  @default(false)
  orders Order[]
  addresses Address[]
}


model Service{
   id      Int      @id @default(autoincrement())
   iconUrl String
   name    String
   categories   Category[]
    orders Order[]
}



model Category{
   id      Int      @id @default(autoincrement())
   iconUrl String
   name    String
   serviceId   Int    
   service     Service   @relation(fields: [serviceId], references: [id]) 
   subcategories   SubCategory[]
    orders Order[]
}



model SubCategory{
   id      Int      @id @default(autoincrement())
   iconUrl String
   name    String
   categoryId   Int    
   category     Category   @relation(fields: [categoryId], references: [id]) 
   medicalCatrgories MedicalCategory[]
   orders Order[]
}


model Medical{
   id      Int      @id @default(autoincrement())
   iconUrl String
   name    String
   lat  Float
   lng Float
   address String 
   medicalCatrgories MedicalCategory[]
   orders Order[]
   availabilities Availability[]
}


model MedicalCategory{
   id      Int      @id @default(autoincrement())
   medicalId Int
   subCategoryId Int
   createdAt         DateTime         @default(now())
   medical           Medical          @relation(fields: [medicalId], references: [id])
   subCategory       SubCategory       @relation(fields: [subCategoryId], references: [id])
   price    Float @default(0)
}



model Order{
   id      Int      @id @default(autoincrement())
   createdAt         DateTime         @default(now())
   serviceId   Int
   categoryId Int
   subCategoryId Int
   medicalId Int
   userId Int
   price Float @default(0)
   address String
   lat Float?
   lng Float?
   paymetStatus String @default("pending")
   orderStatus String @default("pending")
   declinedReason String?
   additionalInfo String?
   orderDate     DateTime

   date String?
   startTime Int?
   endTime Int?

   
   medical           Medical          @relation(fields: [medicalId], references: [id])
   service       Service       @relation(fields: [serviceId], references: [id])
   category       Category       @relation(fields: [categoryId], references: [id])
   subCategory       SubCategory       @relation(fields: [subCategoryId], references: [id])
   user       User       @relation(fields: [userId], references: [id])
}


model Availability{
   id  Int @id @default(autoincrement())
   createdAt DateTime @default(now())
   day Int
   startTime Int
   endTime Int
   medicalId Int
   medical Medical  @relation(fields: [medicalId], references: [id])
}




model Address{
   id  Int @id @default(autoincrement())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   shortName String
   city String
   district String
   address String
   userId Int
   lat Int
   lng Int
   user       User       @relation(fields: [userId], references: [id])
}